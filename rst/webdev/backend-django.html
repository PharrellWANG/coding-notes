

<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4. Django &mdash; Coding Notes latest documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/aliwang-custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5. Django Rest Framework" href="backend-drf.html" />
    <link rel="prev" title="3. React &amp; Redux" href="frontend-react-redux.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Coding Notes
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">AI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ai/deep-learning.html">1. Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ai/tensorflow.html">2. Tensorflow</a></li>
</ul>
<p class="caption"><span class="caption-text">Unix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../unix/android.html">1. Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/docker.html">2. Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/mac.html">3. Mac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/ubuntu.html">4. Ubuntu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/ssh.html">5. SSH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/zsh-shell.html">6. Zsh Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/supervisor.html">7. Supervisor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/ports.html">8. Ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/git.html">9. Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/svn.html">10. SVN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/anaconda.html">11. Anaconda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/vim.html">12. Vim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/htcondor.html">13. HTCondor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/opencv.html">14. OpenCV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unix/input-method.html">15. Input Method</a></li>
</ul>
<p class="caption"><span class="caption-text">Video Coding</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../videocoding/ffmpeg.html">1. FFMPEG</a></li>
</ul>
<p class="caption"><span class="caption-text">Web Dev</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="frontend-node.html">1. Node</a></li>
<li class="toctree-l1"><a class="reference internal" href="frontend-npm.html">2. NPM</a></li>
<li class="toctree-l1"><a class="reference internal" href="frontend-react-redux.html">3. React &amp; Redux</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. Django</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-to-install-python-packages-from-the-tar-gz-file">4.1. How to install Python packages from the tar.gz file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#django-test-assert-types">4.2. Django Test Assert Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#speeding-up-the-tests">4.3. Speeding up the tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#site-matching-query-does-not-exist">4.4. Site matching query does not exist</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-delete-the-database-and-start-again">4.5. How to delete the database and start again</a></li>
<li class="toctree-l2"><a class="reference internal" href="#auth-terms">4.6. Auth terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#naming-conventions-for-django-projects">4.7. Naming Conventions for Django Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sessions-and-cookies">4.8. Sessions and Cookies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-a-cookie">4.8.1. 1. What is a cookie</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-is-a-session">4.8.2. 2. What is a session</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#relationships-in-models">4.9. Relationships in Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#many-to-one-foreign-key">4.9.1. 1. Many-to-one (foreign key)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#many-to-many-relationships">4.9.2. 2. Many-to-many relationships</a></li>
<li class="toctree-l3"><a class="reference internal" href="#one-to-one-relationships">4.9.3. 3. One-to-one relationships</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#making-queries">4.10. Making Queries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#models-to-be-referred-to">4.10.1. 1. Models to be referred to</a></li>
<li class="toctree-l3"><a class="reference internal" href="#chaining-filters">4.10.2. 2. Chaining filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saving-foreignkey-and-manytomany-fields">4.10.3. 3. Saving ForeignKey and ManyToMany Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="#foreignkey">4.10.4. 4. ForeignKey</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manytomanyfield">4.10.5. 5. ManyToManyField</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sitemaps">4.10.6. 6. Sitemaps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="backend-drf.html">5. Django Rest Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="backend-psql.html">6. PostgreSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="backend-dot.html">7. Django OAuth Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="nginx.html">8. Nginx</a></li>
<li class="toctree-l1"><a class="reference internal" href="http.html">9. HTTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="ssl.html">10. Secure Sockets Layer (SSL/TLS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="internet.html">11. Internet</a></li>
</ul>
<p class="caption"><span class="caption-text">Write the Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dt/sphinx-get-started.html">1. Sphinx Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dt/sphinx-how-to.html">2. Sphinx How To</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dt/markdown.html">3. Markdown How To</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dt/gitbook.html">4. GitBook How To</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dt/mkdocs.html">5. MkDocs</a></li>
</ul>
<p class="caption"><span class="caption-text">Coding Languages</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../colan/python.html">1. Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../colan/cpp.html">2. Cpp</a></li>
</ul>
<p class="caption"><span class="caption-text">Windows</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../win/windows.html">1. Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../win/proxy.html">2. Proxy</a></li>
</ul>
<p class="caption"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/keymaps.html">1. Keymaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/pgp.html">2. PGP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/tmp_info.html">3. Temporary stuff</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/rst_example.html">4. Restructured Text (reST) and Sphinx CheatSheet</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Coding Notes</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">4. </span>Django</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="django">
<h1><span class="section-number">4. </span>Django<a class="headerlink" href="#django" title="Permalink to this headline">¶</a></h1>
<div class="section" id="how-to-install-python-packages-from-the-tar-gz-file">
<h2><span class="section-number">4.1. </span>How to install Python packages from the tar.gz file<a class="headerlink" href="#how-to-install-python-packages-from-the-tar-gz-file" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">ref</dt>
<dd class="field-odd"><p><a class="reference external" href="https://stackoverflow.com/questions/36014334/how-to-install-python-packages-from-the-tar-gz-file-without-using-pip-install">https://stackoverflow.com/questions/36014334/how-to-install-python-packages-from-the-tar-gz-file-without-using-pip-install</a></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">relative_path_to_seaborn.tar.gz</span></code></p>
</div>
<div class="section" id="django-test-assert-types">
<h2><span class="section-number">4.2. </span>Django Test Assert Types<a class="headerlink" href="#django-test-assert-types" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.AssertQuerysetEqual(response.context['latest_question_list'],</span> <span class="pre">['&lt;Question:</span> <span class="pre">Past</span> <span class="pre">question.&gt;'])</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.AssertIn(recent_question.is_published_recently,</span> <span class="pre">True)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.AssertEqual(reponse.status_code,</span> <span class="pre">200)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.AssertContains(response,</span> <span class="pre">'No</span> <span class="pre">polls</span> <span class="pre">are</span> <span class="pre">availbale.')</span></code></p></li>
</ol>
<p>See also <a class="reference internal" href="../colan/python.html#python-assertions-label"><span class="std std-ref">Python Assertions</span></a>.</p>
</div>
<div class="section" id="speeding-up-the-tests">
<h2><span class="section-number">4.3. </span>Speeding up the tests<a class="headerlink" href="#speeding-up-the-tests" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>As long as your tests are properly isolate3d, you can run them in parallel to gain a speed up on multi-core hardware: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">test</span> <span class="pre">--parallel</span></code></p></li>
<li><p>The default password hasher is rather slow by design. If you’re authenticating many users in your tests, you may want to use a custom settings file and set the PASSWORD_HASHERS setting to a faster hashing algorithm:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">PASSWORD_HASHERS</span> <span class="o">=</span> <span class="p">[</span>
<span class="s1">&#39;django.contrib.auth.hashers.MD5PasswordHasher&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="site-matching-query-does-not-exist">
<h2><span class="section-number">4.4. </span>Site matching query does not exist<a class="headerlink" href="#site-matching-query-does-not-exist" title="Permalink to this headline">¶</a></h2>
<p>If you encounter the warning of <code class="docutils literal notranslate"><span class="pre">site</span> <span class="pre">matching</span> <span class="pre">query</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">exist</span></code>, that’s probably due to the fact that you have not specify the <code class="docutils literal notranslate"><span class="pre">SITE_ID</span></code> parameter in your <code class="docutils literal notranslate"><span class="pre">settings.py</span></code>.</p>
<p>For solving this issue, please add <code class="docutils literal notranslate"><span class="pre">SITE_ID</span> <span class="pre">=</span> <span class="pre">1</span></code> to your <code class="docutils literal notranslate"><span class="pre">settings.py</span></code> file.</p>
<p>If adding <code class="docutils literal notranslate"><span class="pre">SITE_ID</span> <span class="pre">=</span> <span class="pre">1</span></code> cannot solve your issue, chances are that you don’t have a site defined in your database and django wants to reference it. Hence you will need to create one. See below.</p>
<p>From a <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">shell</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib.sites.models</span> <span class="kn">import</span> <span class="n">Site</span>
<span class="n">new_site</span> <span class="o">=</span> <span class="n">Site</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="s1">&#39;foo.com&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo.com&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">new_site</span><span class="o">.</span><span class="n">id</span>
</pre></div>
</div>
<p>Now set that site ID in your settings.py to SITE_ID. Hopefully now this issue will be solved.</p>
</div>
<div class="section" id="how-to-delete-the-database-and-start-again">
<h2><span class="section-number">4.5. </span>How to delete the database and start again<a class="headerlink" href="#how-to-delete-the-database-and-start-again" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ rm -f tmp.db db.sqlite3
$ rm -r snippets/migrations
$ python manage.py makemigrations snippets
$ python manage.py migrate
</pre></div>
</div>
</div>
<div class="section" id="auth-terms">
<h2><span class="section-number">4.6. </span>Auth terms<a class="headerlink" href="#auth-terms" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Authentication: authentication verifies a user is who they claim to be.</p></li>
<li><p>Authorization : authorization determines what an authenticated user is allowed to do.</p></li>
</ol>
</div>
<div class="section" id="naming-conventions-for-django-projects">
<h2><span class="section-number">4.7. </span>Naming Conventions for Django Projects<a class="headerlink" href="#naming-conventions-for-django-projects" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You’ll need to avoid naming projects after built-in Python or Django components. In particular, this means you should avoid using names like django (which will conflict with <cite>Django</cite> itself) or <cite>test</cite> (which conflicts with a built-in Python package).</p>
</div>
<p>if you run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ django-admin startproject mysite
</pre></div>
</div>
<p>You will get an directory as below:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>mysite/</dt><dd><ul>
<li><p>manage.py</p></li>
<li><dl class="simple">
<dt>mysite/</dt><dd><ul>
<li><p>__init__.py</p></li>
<li><p>settings.py</p></li>
<li><p>urls.py</p></li>
<li><p>wsgi.py</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>Be aware:
1. The outer mysite/ root directory is just a container for your project. Its name doesn’t matter to Django; <strong>you can rename it to anything you like</strong>.
2. The inner mysite/ directory is <strong>the actual Python package</strong> for your project. Its name is <strong>the Python package name</strong> you’ll need to use to import anything inside it (e.g. mysite.urls).</p>
<p>Hence</p>
<ul class="simple">
<li><p>you can rename the name of the outer directory to any other name as you like.</p></li>
<li><p>Do not rename the inner directory, especially after you have some codes using its name for import already.</p></li>
</ul>
<p>Create our poll app right next to your manage.py file so that it can be imported as its own top-level module, rather than a submodule of mysite.</p>
<p>To start your app, make sure you’re in the same directory as manage.py and type this command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python manage.py startapp polls
</pre></div>
</div>
</div>
<div class="section" id="sessions-and-cookies">
<h2><span class="section-number">4.8. </span>Sessions and Cookies<a class="headerlink" href="#sessions-and-cookies" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-is-a-cookie">
<h3><span class="section-number">4.8.1. </span>1. What is a cookie<a class="headerlink" href="#what-is-a-cookie" title="Permalink to this headline">¶</a></h3>
<p>A cookie is a small piece of text stored on a user’s computer by their browser. Common uses for cookies are authentication, storing of site preferences, shopping cart items, and server session identification.</p>
<p>Each time the users’ web browser interacts with a web server it will pass the cookie information to the web server. Only the cookies stored by the browser that relate to the domain in the requested URL will be sent to the server. This means that cookies that relate to www.example.com will not be sent to www.exampledomain.com.</p>
<p>In essence, a cookie is a great way of linking one page to the next for a user’s interaction with a web site or web application.</p>
</div>
<div class="section" id="what-is-a-session">
<h3><span class="section-number">4.8.2. </span>2. What is a session<a class="headerlink" href="#what-is-a-session" title="Permalink to this headline">¶</a></h3>
<p>A session can be defined as a server-side storage of information that is desired to persist throughout the user’s interaction with the web site or web application.</p>
<p>Instead of storing large and constantly changing information via cookies in the user’s browser, only a unique identifier is stored on the client side (called a “session id”). This session id is passed to the web server every time the browser makes an HTTP request (ie a page link or AJAX request). The web application pairs this session id with it’s internal database and retrieves the stored variables for use by the requested page.</p>
<dl class="field-list simple">
<dt class="field-odd">Stanford University cs142</dt>
<dd class="field-odd"><p><a class="reference external" href="https://web.stanford.edu/~ouster/cgi-bin/cs142-fall10/lecture.php?topic=cookie">https://web.stanford.edu/~ouster/cgi-bin/cs142-fall10/lecture.php?topic=cookie</a></p>
</dd>
</dl>
</div>
</div>
<div class="section" id="relationships-in-models">
<h2><span class="section-number">4.9. </span>Relationships in Models<a class="headerlink" href="#relationships-in-models" title="Permalink to this headline">¶</a></h2>
<p>Clearly, the power of <em>relational databases</em> lies in relating tables to each other.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Three most common types of <em>database relationships</em>:</p>
<ul class="simple">
<li><p>many-to-one</p></li>
<li><p>many-to-many</p></li>
<li><p>one-to-one</p></li>
</ul>
</div>
<div class="section" id="many-to-one-foreign-key">
<h3><span class="section-number">4.9.1. </span>1. Many-to-one (foreign key)<a class="headerlink" href="#many-to-one-foreign-key" title="Permalink to this headline">¶</a></h3>
<p>For example, if a Car model has a Manufacturer – that is, a Manufacturer makes multiple cars but each Car only has one Manufacturer – use the following definitions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="k">class</span> <span class="nc">Manufacturer</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="c1"># ...</span>
    <span class="k">pass</span>
<span class="k">class</span> <span class="nc">Car</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">manufacturer</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Manufacturer</span><span class="p">)</span>
    <span class="c1"># ...</span>
</pre></div>
</div>
<p>It is like, now you have user model, and you created a PasswordReset model with user ad the foreign key, and you can sotre multiple records in PasswordReset model for the same user.</p>
<p>This is the meaning of the <code class="docutils literal notranslate"><span class="pre">foreign</span> <span class="pre">key</span></code>, or <code class="docutils literal notranslate"><span class="pre">many-to-one</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It’s suggested, but not required, that the name of a ForeignKey field (manufacturer in the example above) be the name of the model, lowercase. You can, of course, call the field whatever you want</p>
</div>
<p>If you delete a reporter, his articles will be deleted (assuming that the ForeignKey was defined with django.db.models.ForeignKey.on_delete set to CASCADE, which is the default):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">[&lt;Article: John&#39;s second story&gt;, &lt;Article: Paul&#39;s story&gt;, &lt;Article: This is a test&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Reporter</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;first_name&#39;</span><span class="p">)</span>
<span class="go">[&lt;Reporter: John Smith&gt;, &lt;Reporter: Paul Jones&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">[&lt;Article: John&#39;s second story&gt;, &lt;Article: This is a test&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Reporter</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;first_name&#39;</span><span class="p">)</span>
<span class="go">[&lt;Reporter: John Smith&gt;]</span>
</pre></div>
</div>
<p>Similarly, if you delete a user, other records in other tables (tables which are using <strong>user</strong> model as foreign key) should also be deleted.</p>
</div>
<div class="section" id="many-to-many-relationships">
<h3><span class="section-number">4.9.2. </span>2. Many-to-many relationships<a class="headerlink" href="#many-to-many-relationships" title="Permalink to this headline">¶</a></h3>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>add m-t-m</p>
</div>
</div>
<div class="section" id="one-to-one-relationships">
<h3><span class="section-number">4.9.3. </span>3. One-to-one relationships<a class="headerlink" href="#one-to-one-relationships" title="Permalink to this headline">¶</a></h3>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>add o-t-o</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are some features provided by Django that i am not using them frequently while they are useful. See below.</p>
</div>
</div>
</div>
<div class="section" id="making-queries">
<h2><span class="section-number">4.10. </span>Making Queries<a class="headerlink" href="#making-queries" title="Permalink to this headline">¶</a></h2>
<div class="section" id="models-to-be-referred-to">
<h3><span class="section-number">4.10.1. </span>1. Models to be referred to<a class="headerlink" href="#models-to-be-referred-to" title="Permalink to this headline">¶</a></h3>
<p>Throughout this guide (and in the reference), we’ll refer to the following models, which comprise a Weblog application:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>              <span class="c1"># __unicode__ on Python 2</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="k">class</span> <span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>              <span class="c1"># __unicode__ on Python 2</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Blog</span><span class="p">)</span>
    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">body_text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">pub_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">mod_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">authors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Author</span><span class="p">)</span>
    <span class="n">n_comments</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">n_pingbacks</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">rating</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>              <span class="c1"># __unicode__ on Python 2</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">headline</span>
</pre></div>
</div>
</div>
<div class="section" id="chaining-filters">
<h3><span class="section-number">4.10.2. </span>2. Chaining filters<a class="headerlink" href="#chaining-filters" title="Permalink to this headline">¶</a></h3>
<p>The result of refining a <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> is itself a <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code>, so it’s possible to chain refinements together. For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">headline__startswith</span><span class="o">=</span><span class="s1">&#39;What&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pub_date__gte</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pub_date__gte</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>Notice the usage of <code class="docutils literal notranslate"><span class="pre">exclude</span></code>.</p>
</div>
<div class="section" id="saving-foreignkey-and-manytomany-fields">
<h3><span class="section-number">4.10.3. </span>3. Saving ForeignKey and ManyToMany Fields<a class="headerlink" href="#saving-foreignkey-and-manytomany-fields" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="foreignkey">
<h3><span class="section-number">4.10.4. </span>4. ForeignKey<a class="headerlink" href="#foreignkey" title="Permalink to this headline">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">blog.models</span> <span class="k">import</span> <span class="n">Entry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cheese_blog</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Cheddar Talk&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entry</span><span class="o">.</span><span class="n">blog</span> <span class="o">=</span> <span class="n">cheese_blog</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entry</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="manytomanyfield">
<h3><span class="section-number">4.10.5. </span>5. ManyToManyField<a class="headerlink" href="#manytomanyfield" title="Permalink to this headline">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">john</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;John&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">paul</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Paul&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">george</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;George&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ringo</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ringo&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entry</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">paul</span><span class="p">,</span> <span class="n">george</span><span class="p">,</span> <span class="n">ringo</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">filter()</span></code> will always give you a <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code>, even if only <strong>a single object</strong> matches the query - in this case, it will be a <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> containing <strong>a single element</strong>.</p>
</div>
</div>
<div class="section" id="sitemaps">
<h3><span class="section-number">4.10.6. </span>6. Sitemaps<a class="headerlink" href="#sitemaps" title="Permalink to this headline">¶</a></h3>
<p>What are sitemaps:</p>
<p>Sitemaps are an easy way for webmasters to inform search engines about pages on their sites that are available for crawling. In its simplest form, a Sitemap is an XML file that lists URLs for a site along with additional metadata about each URL (when it was last updated, how often it usually changes, and how important it is, relative to other URLs in the site) so that search engines can more intelligently crawl the site.
Web crawlers usually discover pages from links within the site and from other sites. Sitemaps supplement this data to allow crawlers that support Sitemaps to pick up all URLs in the Sitemap and learn about those URLs using the associated metadata. Using the Sitemap protocol does not guarantee that web pages are included in search engines, but provides hints for web crawlers to do a better job of crawling your site.</p>
<p>Ref:</p>
<dl class="field-list simple">
<dt class="field-odd">Django Many-to-one relationship</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.djangoproject.com/en/1.8/topics/db/examples/many_to_one/">https://docs.djangoproject.com/en/1.8/topics/db/examples/many_to_one/</a></p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="backend-drf.html" class="btn btn-neutral float-right" title="5. Django Rest Framework" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="frontend-react-redux.html" class="btn btn-neutral float-left" title="3. React &amp; Redux" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017-2020, WANG Zhenxiang Pharrell

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>